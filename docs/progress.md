# 프로젝트 문제 해결 및 최종 점검 (2025-11-15)

지금까지 발생했던 문제들과 해결 과정을 단계별로 정리하고, 최종 기능 동작을 확인합니다.

---

### 1. 실시간 재고 업데이트 문제 해결

- [x] **문제 진단:** 재고 목록 화면이 실시간으로 업데이트되지 않는 문제 발생.
- [x] **원인 파악:** Supabase 무료 플랜의 정책 변경으로 실시간 구독(Realtime) 기능 사용 불가 확인.
- [x] **해결:**
    - [x] `index.tsx`: `useFocusEffect`를 적용하여, 화면이 보일 때마다 데이터를 새로고침하도록 수정.
    - [x] `index.tsx`: 헤더에 '새로고침' 버튼을 추가하여 수동 업데이트 기능 제공.
    - [x] `scan.tsx`: 상품 추가 성공 시, 재고 목록 탭으로 자동 이동하여 즉시 결과를 확인하도록 개선.

### 2. 백엔드 연동 및 데이터베이스 문제 해결

- [x] **문제 진단:** 바코드 스캔 시 서버와 통신 실패 및 데이터베이스 저장 오류 발생.
- [x] **원인 파악:**
    - [x] 프론트엔드-백엔드 간 IP 주소 불일치.
    - [x] PC 방화벽으로 인한 포트(`5000`, `8081`) 연결 차단.
    - [x] API 응답 필드(`product_name`)와 프론트엔드 기대 필드(`name`) 불일치.
    - [x] `categories` 테이블 데이터 누락 및 ID 시퀀스 문제로 인한 외래 키 제약조건 위반.
- [x] **해결:**
    - [x] `scan.tsx`의 `BACKEND_URL`을 실제 서버 IP로 수정.
    - [x] Windows 방화벽에 포트 `5000`번과 `8081`번에 대한 인바운드 규칙 추가.
    - [x] `scan.tsx`에서 `product_name`을 `name`으로 매핑하도록 로직 수정.
    - [x] `TRUNCATE TABLE ... RESTART IDENTITY` 명령으로 `categories` 테이블 및 ID 시퀀스를 초기화하고, `categories_master.csv` 데이터 재임포트.

### 3. 로컬 빌드 및 실행 (Android Studio)

- [x] **빌드 방식 전환:** `eas build`의 횟수 제한 및 용량 문제로 인해, **Android Studio를 사용한 로컬 빌드** 방식으로 전환.
- [x] **문제 해결:** 로컬 빌드 과정에서 발생한 아래 문제들을 순차적으로 해결.
    - [x] **`Not authorized for developing` 오류:** 안드로이드 기기에서 'USB 디버깅 허용' 팝업을 승인하여 해결.
    - [x] **`INSTALL_FAILED_VERSION_DOWNGRADE` 오류:** 기기에 설치된 기존의 높은 버전 앱을 수동으로 삭제하여 해결.
    - [x] **`SocketTimeoutException` 오류:** PC 방화벽 규칙을 추가하여 기기와 Metro 서버 간의 통신 문제 해결.
- [x] **최종 성공:** Android Studio를 통해 앱을 성공적으로 빌드하고 기기에서 실행 완료.

### 4. 최종 기능 동작 확인

- [x] **기능 검증 완료:** Android Studio를 통해 로컬 빌드된 앱에서 아래의 핵심 기능들이 모두 정상적으로 동작하는 것을 최종 확인.
    - [x] 바코드 스캔 및 백엔드 API를 통한 상품 정보 조회.
    - [x] 유통기한 입력 및 재고 추가 (Supabase DB 저장).
    - [x] 재고 목록 화면 자동 새로고침 및 수동 새로고침.
